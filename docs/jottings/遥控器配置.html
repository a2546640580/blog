<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>配置遥控器 | 猪都能上天</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    <link rel="icon" href="https://www.zpzpup.com/assets/image/favicon.ico">
    <script src="/blog/assets/js/bodyClick.js"></script>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/blog/assets/css/0.styles.8007388d.css" as="style"><link rel="preload" href="/blog/assets/js/app.f4a18f0f.js" as="script"><link rel="preload" href="/blog/assets/js/3.01b96ee1.js" as="script"><link rel="preload" href="/blog/assets/js/1.8a71ccc8.js" as="script"><link rel="preload" href="/blog/assets/js/99.c2649bef.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.a84d0684.js"><link rel="prefetch" href="/blog/assets/js/100.0ef759b2.js"><link rel="prefetch" href="/blog/assets/js/11.0b2c2448.js"><link rel="prefetch" href="/blog/assets/js/12.1316e38d.js"><link rel="prefetch" href="/blog/assets/js/13.ff74ae97.js"><link rel="prefetch" href="/blog/assets/js/14.dfeab87a.js"><link rel="prefetch" href="/blog/assets/js/15.7883e157.js"><link rel="prefetch" href="/blog/assets/js/16.cf4efdca.js"><link rel="prefetch" href="/blog/assets/js/17.24a94b5f.js"><link rel="prefetch" href="/blog/assets/js/18.e91787c4.js"><link rel="prefetch" href="/blog/assets/js/19.3080e994.js"><link rel="prefetch" href="/blog/assets/js/20.87b5b9c9.js"><link rel="prefetch" href="/blog/assets/js/21.dd1c2a33.js"><link rel="prefetch" href="/blog/assets/js/22.034c96c5.js"><link rel="prefetch" href="/blog/assets/js/23.107e37c9.js"><link rel="prefetch" href="/blog/assets/js/24.566f387e.js"><link rel="prefetch" href="/blog/assets/js/25.0d41a01a.js"><link rel="prefetch" href="/blog/assets/js/26.511a9a3f.js"><link rel="prefetch" href="/blog/assets/js/27.1dac6d97.js"><link rel="prefetch" href="/blog/assets/js/28.78b27a94.js"><link rel="prefetch" href="/blog/assets/js/29.fa4c2179.js"><link rel="prefetch" href="/blog/assets/js/30.f636e6da.js"><link rel="prefetch" href="/blog/assets/js/31.818cdf67.js"><link rel="prefetch" href="/blog/assets/js/32.698f0782.js"><link rel="prefetch" href="/blog/assets/js/33.f2cc33df.js"><link rel="prefetch" href="/blog/assets/js/34.a5ac7569.js"><link rel="prefetch" href="/blog/assets/js/35.01df904a.js"><link rel="prefetch" href="/blog/assets/js/36.56f5b7ab.js"><link rel="prefetch" href="/blog/assets/js/37.2065e087.js"><link rel="prefetch" href="/blog/assets/js/38.4d6d6cd3.js"><link rel="prefetch" href="/blog/assets/js/39.44d7080b.js"><link rel="prefetch" href="/blog/assets/js/4.3a6e8d87.js"><link rel="prefetch" href="/blog/assets/js/40.90ff09ca.js"><link rel="prefetch" href="/blog/assets/js/41.1faaf7d2.js"><link rel="prefetch" href="/blog/assets/js/42.39852eb3.js"><link rel="prefetch" href="/blog/assets/js/43.9fa0f61a.js"><link rel="prefetch" href="/blog/assets/js/44.ec5bf9bb.js"><link rel="prefetch" href="/blog/assets/js/45.1177c2ff.js"><link rel="prefetch" href="/blog/assets/js/46.9e4cf7ee.js"><link rel="prefetch" href="/blog/assets/js/47.3ae59f69.js"><link rel="prefetch" href="/blog/assets/js/48.137cd5dc.js"><link rel="prefetch" href="/blog/assets/js/49.dd4cee3a.js"><link rel="prefetch" href="/blog/assets/js/5.09ecaa88.js"><link rel="prefetch" href="/blog/assets/js/50.a72282fe.js"><link rel="prefetch" href="/blog/assets/js/51.58e761fd.js"><link rel="prefetch" href="/blog/assets/js/52.23953fc4.js"><link rel="prefetch" href="/blog/assets/js/53.78a6eea2.js"><link rel="prefetch" href="/blog/assets/js/54.59dd9a9e.js"><link rel="prefetch" href="/blog/assets/js/55.777388a4.js"><link rel="prefetch" href="/blog/assets/js/56.cdf253a8.js"><link rel="prefetch" href="/blog/assets/js/57.db7d0eb5.js"><link rel="prefetch" href="/blog/assets/js/58.e2bd6a20.js"><link rel="prefetch" href="/blog/assets/js/59.6ca4d681.js"><link rel="prefetch" href="/blog/assets/js/6.2fc7d0da.js"><link rel="prefetch" href="/blog/assets/js/60.d1942e51.js"><link rel="prefetch" href="/blog/assets/js/61.1f686f6b.js"><link rel="prefetch" href="/blog/assets/js/62.88795215.js"><link rel="prefetch" href="/blog/assets/js/63.b779cac2.js"><link rel="prefetch" href="/blog/assets/js/64.7a8f4a55.js"><link rel="prefetch" href="/blog/assets/js/65.779d288e.js"><link rel="prefetch" href="/blog/assets/js/66.11408b98.js"><link rel="prefetch" href="/blog/assets/js/67.a0c0c71e.js"><link rel="prefetch" href="/blog/assets/js/68.e620208d.js"><link rel="prefetch" href="/blog/assets/js/69.c3b83071.js"><link rel="prefetch" href="/blog/assets/js/7.0fac4cc1.js"><link rel="prefetch" href="/blog/assets/js/70.3f0f604c.js"><link rel="prefetch" href="/blog/assets/js/71.566b44f8.js"><link rel="prefetch" href="/blog/assets/js/72.cf46bbcd.js"><link rel="prefetch" href="/blog/assets/js/73.c2239cb9.js"><link rel="prefetch" href="/blog/assets/js/74.305996ed.js"><link rel="prefetch" href="/blog/assets/js/75.7be65f10.js"><link rel="prefetch" href="/blog/assets/js/76.0697db1b.js"><link rel="prefetch" href="/blog/assets/js/77.8d1b3b3d.js"><link rel="prefetch" href="/blog/assets/js/78.d825212d.js"><link rel="prefetch" href="/blog/assets/js/79.e30361b1.js"><link rel="prefetch" href="/blog/assets/js/8.954c1416.js"><link rel="prefetch" href="/blog/assets/js/80.40a69e2f.js"><link rel="prefetch" href="/blog/assets/js/81.b84fabef.js"><link rel="prefetch" href="/blog/assets/js/82.ced7bc64.js"><link rel="prefetch" href="/blog/assets/js/83.1e2ad9f0.js"><link rel="prefetch" href="/blog/assets/js/84.48e87fce.js"><link rel="prefetch" href="/blog/assets/js/85.d26c555f.js"><link rel="prefetch" href="/blog/assets/js/86.ca4ca2a2.js"><link rel="prefetch" href="/blog/assets/js/87.7978fe33.js"><link rel="prefetch" href="/blog/assets/js/88.30868962.js"><link rel="prefetch" href="/blog/assets/js/89.6549fcb8.js"><link rel="prefetch" href="/blog/assets/js/9.7523f459.js"><link rel="prefetch" href="/blog/assets/js/90.27ddb658.js"><link rel="prefetch" href="/blog/assets/js/91.ce0e209d.js"><link rel="prefetch" href="/blog/assets/js/92.0a02d5db.js"><link rel="prefetch" href="/blog/assets/js/93.fb22c380.js"><link rel="prefetch" href="/blog/assets/js/94.9dc38d42.js"><link rel="prefetch" href="/blog/assets/js/95.98fecc23.js"><link rel="prefetch" href="/blog/assets/js/96.74b3eace.js"><link rel="prefetch" href="/blog/assets/js/97.df60ed53.js"><link rel="prefetch" href="/blog/assets/js/98.056f526c.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.8007388d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7a6c954e><div data-v-7a6c954e><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-7a6c954e data-v-7a6c954e><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-548f7490 data-v-7a6c954e data-v-7a6c954e><h3 class="title" style="display:none;" data-v-548f7490 data-v-548f7490>猪都能上天</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-548f7490 data-v-548f7490><input type="password" value="" data-v-548f7490> <span data-v-548f7490>Konck! Knock!</span> <button data-v-548f7490>OK</button></label> <div class="footer" style="display:none;" data-v-548f7490 data-v-548f7490><span data-v-548f7490><i class="iconfont reco-theme" data-v-548f7490></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-548f7490>vuePress-theme-reco</a></span> <span data-v-548f7490><i class="iconfont reco-copyright" data-v-548f7490></i> <a data-v-548f7490><span data-v-548f7490>sg</span>
            
          <!---->
          2022
        </a></span></div></div> <div class="hide" data-v-7a6c954e><header class="navbar" data-v-7a6c954e><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="https://www.zpzpup.com/assets/image/avatar.png" alt="猪都能上天" class="logo"> <span class="site-name">猪都能上天</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont reco-home"></i>
  随意一点的主页
</a></div><div class="nav-item"><a href="/blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  莫名其妙的时间轴
</a></div><div class="nav-item"><a href="/blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  踩坑避雷请注意
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      很厉害的文章
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/docs/jottings/Git命令清单.html" class="nav-link"><i class="iconfont undefined"></i>
   工作学习
</a></li><li class="dropdown-item"><!----> <a href="/blog/docs/Android/Activity.html" class="nav-link"><i class="iconfont undefined"></i>
  Android基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系我吧
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.baidu.com/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7a6c954e></div> <aside class="sidebar" data-v-7a6c954e><div class="personal-info-wrapper" data-v-ec2c9702 data-v-7a6c954e><img src="https://www.zpzpup.com/assets/image/avatar.png" alt="author-avatar" class="personal-img" data-v-ec2c9702> <h3 class="name" data-v-ec2c9702>
    sg
  </h3> <div class="num" data-v-ec2c9702><div data-v-ec2c9702><h3 data-v-ec2c9702>42</h3> <h6 data-v-ec2c9702>文章</h6></div> <div data-v-ec2c9702><h3 data-v-ec2c9702>14</h3> <h6 data-v-ec2c9702>标签</h6></div></div> <hr data-v-ec2c9702></div> <nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont reco-home"></i>
  随意一点的主页
</a></div><div class="nav-item"><a href="/blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  莫名其妙的时间轴
</a></div><div class="nav-item"><a href="/blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  踩坑避雷请注意
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      很厉害的文章
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/docs/jottings/Git命令清单.html" class="nav-link"><i class="iconfont undefined"></i>
   工作学习
</a></li><li class="dropdown-item"><!----> <a href="/blog/docs/Android/Activity.html" class="nav-link"><i class="iconfont undefined"></i>
  Android基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系我吧
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.baidu.com/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><a href="/blog/docs/jottings/Git命令清单.html" class="sidebar-link">Git使用及命令清单</a></li><li><a href="/blog/docs/jottings/makefile.html" class="sidebar-link">Makefile</a></li><li><a href="/blog/docs/jottings/AndroidMK.html" class="sidebar-link">Android.mk</a></li><li><a href="/blog/docs/jottings/开机精灵.html" class="sidebar-link">开机精灵</a></li><li><a href="/blog/docs/jottings/shell脚本.html" class="sidebar-link">shell脚本</a></li><li><a href="/blog/docs/jottings/遥控器配置.html" class="active sidebar-link">配置遥控器</a></li><li><a href="/blog/docs/jottings/kl文件及相关命令.html" class="sidebar-link">kl文件及其相关命令</a></li><li><a href="/blog/docs/jottings/adb命令.html" class="sidebar-link">adb命令</a></li><li><a href="/blog/docs/jottings/系统属性.html" class="sidebar-link">系统属性</a></li><li><a href="/blog/docs/jottings/sharedUserId作用.html" class="sidebar-link">sharedUserid的作用</a></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-548f7490 data-v-7a6c954e><h3 class="title" style="display:none;" data-v-548f7490 data-v-548f7490>配置遥控器</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-548f7490 data-v-548f7490><input type="password" value="" data-v-548f7490> <span data-v-548f7490>Konck! Knock!</span> <button data-v-548f7490>OK</button></label> <div class="footer" style="display:none;" data-v-548f7490 data-v-548f7490><span data-v-548f7490><i class="iconfont reco-theme" data-v-548f7490></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-548f7490>vuePress-theme-reco</a></span> <span data-v-548f7490><i class="iconfont reco-copyright" data-v-548f7490></i> <a data-v-548f7490><span data-v-548f7490>sg</span>
            
          <!---->
          2022
        </a></span></div></div> <div data-v-7a6c954e><main class="page"><div class="page-title" style="display:none;"><h1>配置遥控器</h1> <div data-v-01d8a6a8><i class="iconfont reco-account" data-v-01d8a6a8><span data-v-01d8a6a8>sg</span></i> <i class="iconfont reco-date" data-v-01d8a6a8><span data-v-01d8a6a8>2022-08-19</span></i> <i class="iconfont reco-eye" data-v-01d8a6a8><span id="/blog/docs/jottings/%E9%81%A5%E6%8E%A7%E5%99%A8%E9%85%8D%E7%BD%AE.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-01d8a6a8><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <!----></div></div> <div class="theme-reco-content content__default" style="display:none;"><h2 id="_2853r配置遥控器"><a href="#_2853r配置遥控器" class="header-anchor">#</a> 2853R配置遥控器</h2> <p>直接在RTD2853R\customer\IR目录下创建相应的.config文件，然后编译脚本source build.sh ，需注意的是在要编译的脚本里面指定.config文件，目前已经适配过的IR协议有：NEC、KONKA、SONY、三星</p> <p><a data-fancybox="" title="image-20220817175130793" href="https://raw.githubusercontent.com/shug666/image/master/images/image-20220817175130793.png"><img src="https://raw.githubusercontent.com/shug666/image/master/images/image-20220817175130793.png" alt="image-20220817175130793"></a></p> <p>.config文由三部分组成，</p> <ul><li>第一个列是protocol，遥控器的协议。</li> <li>第二列是按键的码值，</li> <li>第三列是keycode，也就是我们要上报的值</li></ul> <p><a data-fancybox="" title="image-20220817174302882" href="https://cdn.jsdelivr.net/gh/shug666/image/images/image-20220817174302882.png"><img src="https://cdn.jsdelivr.net/gh/shug666/image/images/image-20220817174302882.png" alt="image-20220817174302882"></a></p> <h2 id="查看和设置协议的方式"><a href="#查看和设置协议的方式" class="header-anchor">#</a> 查看和设置协议的方式</h2> <p>在配置遥控器之前，需要设置对应的协议，目前已经配置过的遥控器协议有NEC、KONKA,C03.</p> <p>在串口下</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">cat</span> /sys/venus_ir/ir_protocol
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><a data-fancybox="" title="img" href="https://cdn.jsdelivr.net/gh/shug666/image/images/wps2.jpg"><img src="https://cdn.jsdelivr.net/gh/shug666/image/images/wps2.jpg" alt="img"></a></p> <p>同时也可以设置需要的遥控协议，比如</p> <p><strong>无权限时需要输入su命令</strong></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">echo</span> <span class="token number">1</span> <span class="token operator">&gt;</span> /sys/venus_ir/ir_protocol
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="查看遥控器码值"><a href="#查看遥控器码值" class="header-anchor">#</a> 查看遥控器码值</h2> <p>串口下输入：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">echo</span> <span class="token number">1</span> <span class="token operator">&gt;</span>/sys/venus_ir/ir_decode_debug
<span class="token builtin class-name">echo</span> <span class="token number">8</span> <span class="token operator">&gt;</span> /proc/sys/kernel/printk
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>按下遥控按键，看到如下<strong>REG_IR_RP</strong> = [A45BFB04] 就是 得到的ir 键值。</p> <p><a data-fancybox="" title="img" href="https://cdn.jsdelivr.net/gh/shug666/image/images/wps3.jpg"><img src="https://cdn.jsdelivr.net/gh/shug666/image/images/wps3.jpg" alt="img"></a></p> <h2 id="编译时的操作"><a href="#编译时的操作" class="header-anchor">#</a> 编译时的操作</h2> <p>在main_process.sh脚本中的set_IR_Protocol方法里</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">cp</span> -f <span class="token variable">${ir_config_file}</span> <span class="token variable">${ir_bin_tool}</span>/customer/ir_table.config
<span class="token function">rm</span> -rf <span class="token string">&quot;<span class="token variable">${ir_bin_tool}</span>/out/&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token function">mkdir</span> -p <span class="token variable">${ir_bin_tool}</span>/out/
<span class="token function">make</span> -C <span class="token variable">${ir_bin_tool}</span> ir_table_bin

perl <span class="token variable">${toptech_config_path}</span>/scripts/generate_ir_c.pl <span class="token variable">${ir_config_file}</span>  <span class="token variable">${toptech_config_path}</span>/tmp/<span class="token variable">${config_remote_name}</span>.c <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token function">cp</span> -f <span class="token variable">${toptech_config_path}</span>/tmp/<span class="token variable">${config_remote_name}</span>.c <span class="token variable">${root_path}</span>/kernel/linux/linux-4.14/drivers/rtk_kdriver/ir/ir_table/ir_table_default.c
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol><li>将RTD2853R\customer\IR目录下的xxx.config文件拷贝到kernel/android/R/vendor/realtek/tool/image_file_creator/ir_bin_tool/customer/ir_table.config，并清空\ir_bin_tool\out目录（先删除再创建）</li> <li>在ir_bin_tool目录下执行make ir_table_bin命令会在ir_bin_tool/out产生ir_table.bin文件,同时也会拷贝到kernel/android/R/vendor/realtek/common/ATV/data/factory_ro目录下</li> <li>在ir_bin_tool 路径下cmd: make ir_def_table, 自动产生/kernel/linux/linux-4.14/drivers/rtk_kdriver/ir/ir_table/ir_table_default.c文件。（脚本中调用了generate_ir_c.pl将xxx.config生成xxx.c并拷贝到/kernel/linux/linux-4.14/drivers/rtk_kdriver/ir/ir_table/ir_table_default.c）</li></ol> <blockquote><p>注意：IR的默认协议取决于ir_table.config文件最上面的协议，脚本在编译时候会解析该协议，写入到000Bootparam.h，所以我们在有不同协议的ir_table.config文件里面需要根据需要调整码值位置。</p></blockquote> <h2 id="根据按键码值判断协议"><a href="#根据按键码值判断协议" class="header-anchor">#</a> 根据按键码值判断协议</h2> <p>1 代表ir 协议，也就是nec 码，0xf40b（0b 是码值，f4按位或0b ==ff）头码低高八位反码，头码低八位反码，这个应该也适用于三星码</p> <p>10 ir协议，konka码，0x四个0，加上头码低八位，加上码值，因为konka 码目前只配过这一次，目前只能找到这个规律。</p> <h2 id="按键复用问题"><a href="#按键复用问题" class="header-anchor">#</a> 按键复用问题</h2> <p>复用的配置文件_tv_keys.xml放在customers/IR/下面。文件里面修改的话key ir 填入遥控器的名字。</p> <p>Linkedname表示需要复用的这个按键的实际码值。Key name代表的是需要被复用成的按键。例如</p> <p><a data-fancybox="" title="img" href="https://cdn.jsdelivr.net/gh/shug666/image/images/wps1.jpg"><img src="https://cdn.jsdelivr.net/gh/shug666/image/images/wps1.jpg" alt="img"></a></p> <p>linkedName = KEYCODE_MEDIA_PLAY_PAUSE代表这个按键的实际keycode 是这个播放暂停键。Key name =KEYCODE_TIMESHIFT.代表这个播放暂停按键要复用时移按键。</p> <p>目前已经复用的按键都在xml 注释中体现出来了，如果没有体现出来的，那么需要改代码了，这个就建议让RD协助添加这部分。</p> <h2 id="_2851添加遥控器按键流程"><a href="#_2851添加遥控器按键流程" class="header-anchor">#</a> 2851添加遥控器按键流程</h2> <p><strong>1.在\RTD2853R\customer\IR\xxx.config 中添加未定义的keycode</strong></p> <div class="language-c line-numbers-mode"><pre class="language-c"><code> 示例：<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0XB9469F00</span><span class="token punctuation">,</span>KEY_ZERO_FACTORY
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>2.在\RTD2853R\kernel\linux\linux-4.14\include\uapi\linux\input-event-codes.h文件中添加示例：</strong></p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY_ZERO_FACTORY</span>   <span class="token expression"><span class="token number">0x393</span></span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>(<strong>添加这个 值时建议按照顺序添加，方便以后添加按键以及进行代码维护)</strong></p> <p><a data-fancybox="" title="image-20220819114747152" href="https://cdn.jsdelivr.net/gh/shug666/image/images/image-20220819114747152.png"><img src="https://cdn.jsdelivr.net/gh/shug666/image/images/image-20220819114747152.png" alt="image-20220819114747152"></a></p> <p><strong>3.在\RTD2853R\kernel\android\R\device\realtek\common\keylayout\venus_IR_input.kl 中添加一个Key值  keycode</strong></p> <div class="language-c line-numbers-mode"><pre class="language-c"><code> 示例：key <span class="token number">915</span> ZERO_FACTORY
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><a data-fancybox="" title="image-20220819114505445" href="https://cdn.jsdelivr.net/gh/shug666/image/images/image-20220819114505445.png"><img src="https://cdn.jsdelivr.net/gh/shug666/image/images/image-20220819114505445.png" alt="image-20220819114505445"></a></p> <blockquote><p>注:venus_IR_input.kl文件是一个映射文件，是标准 linux 与android 的键值映射文件，可以有很多个。如 0x393 是在 input-event-codes.h 中定义的，kernel 层传到 android 中的值就是 915(0x393 的十进制)。</p></blockquote> <p><strong>4.在\RTD2853R\kernel\android\R\frameworks\native\include\input\InputEventLabels.h 文件的</strong></p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">static</span> <span class="token keyword">const</span> InputEventLabel KEYCODES<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>数组中添加 keylable<span class="token punctuation">.</span>如：
<span class="token function">DEFINE_KEYCODE</span><span class="token punctuation">(</span>ZERO_FACTORY<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>5.在Z:\RTD2853R\kernel\android\R\frameworks\native\include\android\keycodes.h文件中enum{}中添加 keycode.</strong></p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>示例： <span class="token keyword">enum</span><span class="token punctuation">{</span>
	AKEYCODE_ZERO_FACTORY<span class="token operator">=</span><span class="token number">461</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>注：(添加这个值时建议按照顺序添加，方便以后添加按键以及进行代码维护)</strong></p> <p><strong>此处keycodes.h 里的值即是上面keylable定义在数组中的位 置(index)</strong></p> <blockquote><p>这个文件映射的是Android中的键值，这个键值和InputEventLabel.h文件中数组添加的键名有一个映射关系，Android也是借此实现了从Linux键值到Android键值的映射</p> <p>修改这个文件很简单，只要在enum中添加如下值就好了</p></blockquote> <p><strong>6.在 \RTD2853R\kernel\android\R\frameworks\base\core\java\android\view\KeyEvent.java中</strong></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KeyEvent</span> <span class="token keyword">extends</span> <span class="token class-name">InputEvent</span> <span class="token keyword">implements</span> <span class="token class-name">Parcelable</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>类中去添加变量

示例：<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> KEYCODE_ZERO_FACTORY <span class="token operator">=</span> <span class="token number">461</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>**<em>*注：*<em>修改public static final int TOPTECH_ADD_END = KEYCODE_ZERO_FACTORY;</em></em></p> <blockquote><p>Andriod借此文件把键值从c语言转到java语言。</p> <p>变量名字与keycodes.h中比较少了开头的A，键值保持不变。</p></blockquote> <p><strong>7.在\RTD2853R\kernel\android\R\frameworks\base\core\res\res\values\attrs.xml文件中</strong></p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>attr</span><span class="token punctuation">&gt;</span></span>标签中添加示例：
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enum</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>KEYCODE_ZERO_FACTORY<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>461<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>8.两种方式测试：</strong></p> <p>（1）在AS的任一demo中MainActicity中添加onKeyup方法（这种方式便于测试按键）</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>示例：<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onKeyUp</span><span class="token punctuation">(</span><span class="token keyword">int</span> keyCode<span class="token punctuation">,</span> <span class="token class-name">KeyEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">boolean</span> result <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>keyCode <span class="token operator">==</span><span class="token number">461</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">&quot;zero&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;------add key successfully...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>通过adb connect ip(板卡ip，在串口ifconfig)命令连接板卡，在AS中直接安装到TV平台</strong></p> <p>（2）\RTD2853R\kernel\android\R\external\replicaisland\src\com\replica\replicaisland\MainMenuActivity.java</p> <p>在 MainMenuActivity 代码的 onKeyup()方法中添加打印，方便测试添加按键是否成功。(也可以在其他活动中添加打印，注意导包)</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>示例： <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onKeyUp</span><span class="token punctuation">(</span><span class="token keyword">int</span> keyCode<span class="token punctuation">,</span> <span class="token class-name">KeyEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// TODO Auto-generated method stub</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>keyCode<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token keyword">case</span> <span class="token class-name">KeyEvent</span><span class="token punctuation">.</span>KEYCODE_ZERO_FACTORY<span class="token operator">:</span><span class="token punctuation">{</span>

            <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">&quot;zero&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;------add key successfully...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>9.PhoneWindowManager 添加按键功能</strong></p> <p>接下来就是处理自己的功能了，此时按键已经通过 onKeyEvent()拿到，如果你想全局处理，可以在 PhoneWindowManager 的</p> <p>interceptKeyBeforeQueueing 方法添加功能，如:</p> <p><img src="https://raw.githubusercontent.com/shug666/image/main/images/a2090e03b7dd4c1a8d110d3e36b72475.png" alt="img"></p> <p><strong>10.添加完成后需要在\RTD2853R\kernel\android\R目录下使用<em>make update-api</em>命令对current.txt（/kernel/android/R/frameworks/base/api/current.txt目录下文件）进行更新。</strong></p> <p>可用git status 查看文件修改(不更新编译时会报错)</p> <p><strong>注意：提交代码时需要提交current.txt</strong>**</p> <p><strong>11.用对应客户脚本编译代码（脚本里的遥控器编号需与\RTD2853R\customer\IR下编写的对应），编译无误后将系统烧到板子上</strong></p> <p>在串口中输入 <em><strong>*logcat -s &quot;tag值&quot;*</strong></em> 查看打印结果。结果正确表示添加按键成功</p> <h2 id="注意事项"><a href="#注意事项" class="header-anchor">#</a> 注意事项</h2> <p>编译build.sh的时候会提示下面三个命令，每次提示错误后，依次执行编译即可</p> <p>执行make命令如果报错找不到命令则要执行source build/envsetup.sh，然后输入lunch命令</p> <p><a href="https://blog.csdn.net/a567890k/article/details/79412382" target="_blank" rel="noopener noreferrer">可参考build/envsetup.sh 简介<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>make api-stubs-docs-non-updatable-update-current-api</p> <p>make api-stubs-docs-update-current-api</p> <p>make test-api-stubs-docs-update-current-api</p> <p>使用git clone克隆时可以先使用武汉地址拉下来，然后修改.git/config文件为深圳地址然后pull命令更新这样更节省时间</p> <p>武汉地址ssh://git@162.168.0.245/RTD2853R</p> <p>深圳地址ssh://git@58.250.251.47:20111RTD2853R</p></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2022/12/10 18:02:59</span></div></footer> <!----> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div id="goTop" class="hide-cat" data-v-bf92849a></div><div></div></div></div>
    <script src="/blog/assets/js/app.f4a18f0f.js" defer></script><script src="/blog/assets/js/3.01b96ee1.js" defer></script><script src="/blog/assets/js/1.8a71ccc8.js" defer></script><script src="/blog/assets/js/99.c2649bef.js" defer></script>
  </body>
</html>
