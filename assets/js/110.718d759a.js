(window.webpackJsonp=window.webpackJsonp||[]).push([[110],{562:function(s,n,a){"use strict";a.r(n);var t=a(0),e=Object(t.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("作为Android framework 开发程序猿，你所不知道的ninja编译工具有多强大。")]),s._v(" "),n("p",[s._v("原生安卓编译大概有以下几个步骤：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("①Soong 的自举(bootstrap);\n\n②收集 Android.bp,生成 out/soong/build.ninja 文件;\n\n③收集 Android.mk,生成 out/build-.ninja 与 out/combined-.ninja 文件;\n\n④ 执行 Ninja 文件，进行编译。这个 combined-*.ninja 文件,执行入口。\n在我们模块开发，模块编译的时候，使用 mm、mma 单模块编译会重复上面的步骤，\n是一个漫等待过程。你不知道的是，实际上在没有改变Android.bp和Android.mk文件时，\n不需要执行前三步的、只需要执行第四步，所以要是能够能直接执行第四步，\n就能能够大大减少编译编译时长。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[n("strong",[s._v("重点：")])]),s._v(" "),n("p",[n("strong",[n("em",[s._v("实际上在没有改变 Android.bp 和 Android.mk 文件时，不需要执行前三步的、只需要执行第四步，所以要是能够能直接执行第四步，就能能够大大减少编译编译时长。")])])]),s._v(" "),n("h2",{attrs:{id:"创建脚本ninja-lee-sh"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建脚本ninja-lee-sh"}},[s._v("#")]),s._v(" 创建脚本ninja-lee.sh")]),s._v(" "),n("p",[s._v("说明：")]),s._v(" "),n("p",[s._v("$ANDROID_BUILD_TOP 这个是Android源码的根目录 绝对路径：")]),s._v(" "),n("p",[s._v("ex: /media/filesystem/workspace/A13.C01/sprd.mocor13.androidT")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("ninja")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ninja_bin")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ANDROID_BUILD_TOP")]),s._v('/prebuilts/build-tools/linux-x86/bin/ninja"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#ninja_build_file="$ANDROID_BUILD_TOP/out/build-$TARGET_PRODUCT.ninja"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ninja_build_file")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ANDROID_BUILD_TOP")]),s._v("/out/combined-"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$TARGET_PRODUCT")]),s._v('.ninja"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" -f "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ninja_build_file")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"can't find ninja buildfile "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ninja_build_file")]),s._v('"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" -1\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" -f "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ninja_bin")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"can't find ninja binary "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ninja_bin")]),s._v('"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" -1\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ninja_bin")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ninja_build_file")]),s._v("\n\t"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ninja_bin")]),s._v(" -f "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ninja_build_file")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#usage:ninja<modulename>")]),s._v("\nninja "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$*")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("p",[s._v("使用如下：")]),s._v(" "),n("p",[s._v("ex：./ninja-lee.sh SystemUI")]),s._v(" "),n("p",[s._v("ex：./ninja-lee.sh Settings")]),s._v(" "),n("p",[s._v("本文转自 "),n("a",{attrs:{href:"https://mp.weixin.qq.com/s/JFvxK6vht3ErADqrZxcpKw",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://mp.weixin.qq.com/s/JFvxK6vht3ErADqrZxcpKw"),n("OutboundLink")],1),s._v("，如有侵权，请联系删除。")])])}),[],!1,null,null,null);n.default=e.exports}}]);