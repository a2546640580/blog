(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{514:function(e,s,t){"use strict";t.r(s);var a=t(0),n=Object(a.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"问题详情"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题详情"}},[e._v("#")]),e._v(" 问题详情")]),e._v(" "),s("p",[e._v("在SDK环境上将AndroidQ的Email应用搬到AndroidS上使用，使用mm命令进行编译毫无问题，可以正常生产apk，然后就自信满满提交了补丁。但是其他同事更新代码后整体编译，就报了以下的错误：")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('[ 91% 1133/1239] Verifying uses-libraries: out/target/common/obj/APPS/Email_intermediates/manifest/AndroidManifest.xml\nFAILED: out/target/common/obj/APPS/Email_intermediates/enforce_uses_libraries.status\n/bin/bash -c "(rm -f out/target/common/obj/APPS/Email_intermediates/enforce_uses_libraries.status ) && (build/soong/scripts/manifest_check.py     --enforce-uses-libraries        --enforce-uses-libraries-status out/target/common/obj/APPS/Email_intermediates/enforce_uses_libraries.status       --aapt out/host/linux-x86/bin/aapt                                 out/target/common/obj/APPS/Email_intermediates/manifest/AndroidManifest.xml )"\nerror: mismatch in the <uses-library> tags between the build system and the manifest:\n        - required libraries in build system: []\n                         vs. in the manifest: [org.apache.http.legacy]\n        - optional libraries in build system: []\n                         vs. in the manifest: []\n        - tags in the manifest (out/target/common/obj/APPS/Email_intermediates/manifest/AndroidManifest.xml):\n                <uses-library android:name="org.apache.http.legacy" android:required="true"/>\n\nnote: the following options are available:\n        - to temporarily disable the check on command line, rebuild with RELAX_USES_LIBRARY_CHECK=true (this will set compiler filter "verify" and disable AOT-compilation in dexpreopt)\n        - to temporarily disable the check for the whole product, set PRODUCT_BROKEN_VERIFY_USES_LIBRARIES := true in the product makefiles\n        - to fix the check, make build system properties coherent with the manifest\n        - see build/make/Changes.md for details\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br")])]),s("p",[e._v("报错信息是执行manifest_check.py发现，声明请求使用的libraries跟AndroidManifest.xml中声明的不一致，导致的报错。")]),e._v(" "),s("h1",{attrs:{id:"解决方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决方法"}},[e._v("#")]),e._v(" 解决方法")]),e._v(" "),s("p"),e._v(" "),s("p",[e._v("2.令LOCAL_ENFORCE_USES_LIBRARIES的值为false，如在Android.mk/Android.bp中设置：")]),e._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("mk:     LOCAL_ENFORCE_USES_LIBRARIES :"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("\nbp:     enforce_uses_libs: "),s("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("或者LOCAL_MODULE_TAGS设置为tests，LOCAL_COMPATIBILITY_SUITE设置为非空。方案中设置WITH_DEXPREOPT为true等等，具体参考build/make/core/dex_preopt_odex_install.mk")]),e._v(" "),s("p",[e._v("3.正确设置LOCAL_USES_LIBRARIES的值。")]),e._v(" "),s("p",[e._v("本文转自 "),s("a",{attrs:{href:"https://blog.csdn.net/zcyxiaxi/article/details/121555788",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://blog.csdn.net/zcyxiaxi/article/details/121555788"),s("OutboundLink")],1),e._v("，如有侵权，请联系删除。")])])}),[],!1,null,null,null);s.default=n.exports}}]);