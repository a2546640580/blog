(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{499:function(a,r,s){"use strict";s.r(r);var e=s(0),t=Object(e.a)({},(function(){var a=this,r=a._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[r("h2",{attrs:{id:"一-编译framework资源文件"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#一-编译framework资源文件"}},[a._v("#")]),a._v(" 一 : 编译framework资源文件")]),a._v(" "),r("p",[a._v("如果修改android framework资源文件，需要先编译资源文件，然后再编译framework才可以正常引用，")]),a._v(" "),r("p",[a._v("进入项目目录 cd xxx工程目录/frameworks/base/core/res/ 执行mm 编译 framework-res.apk（原生或高通，如果只是修改了core目录下的res资源代码，到这一步就可以了！）")]),a._v(" "),r("p",[a._v("1、编译完后com.android.internal.R中会生成资源的引用。")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://raw.githubusercontent.com/shug666/image/main/images/d2dda8c0f9844c08979c3b31f22264e3.png",alt:"在这里插入图片描述"}})]),a._v(" "),r("p",[a._v("原因解析：")]),a._v(" "),r("p",[a._v("frameworks\\base\\core\\res\\Android.bp文件有以下代码，Android.bp文件描述了模块代码编译的规则，有兴趣可以去深入了解，以前是用Android.mk文件的，现在源码基本都是bp文件了")]),a._v(" "),r("div",{staticClass:"language-sh line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[a._v("android_app "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" //表示编译成一个apk\n    name: "),r("span",{pre:!0,attrs:{class:"token string"}},[a._v('"framework-res"')]),a._v(",  //表示将这个apk命名为framework-res.apk\n    sdk_version: "),r("span",{pre:!0,attrs:{class:"token string"}},[a._v('"core_platform"')]),a._v(",\n    certificate: "),r("span",{pre:!0,attrs:{class:"token string"}},[a._v('"platform"')]),a._v(", \n    resource_dirs: "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("  //指定apk所需要的资源文件路径\n        "),r("span",{pre:!0,attrs:{class:"token string"}},[a._v('"res"')]),a._v(",  //当前res目录\n    "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(",\n    "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n")])]),a._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[a._v("1")]),r("br"),r("span",{staticClass:"line-number"},[a._v("2")]),r("br"),r("span",{staticClass:"line-number"},[a._v("3")]),r("br"),r("span",{staticClass:"line-number"},[a._v("4")]),r("br"),r("span",{staticClass:"line-number"},[a._v("5")]),r("br"),r("span",{staticClass:"line-number"},[a._v("6")]),r("br"),r("span",{staticClass:"line-number"},[a._v("7")]),r("br"),r("span",{staticClass:"line-number"},[a._v("8")]),r("br")])]),r("p",[a._v("所以说，如果我们修改了res目录下的资源文件，只要编译出framework-res.apk文件，然后push进去手机就可以了，其他jar包、so库什么的原因大致一样")]),a._v(" "),r("p",[a._v("如果是修改了/frameworks/base目录下的其他文件，则还需要下面的操作")]),a._v(" "),r("p",[a._v("2、在目录 work/source/frameworks/base/ 下执行mm 编译 framework.jar")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",[r("code",[a._v("make framework-minus-apex（进行部分编译）\n")])])]),r("p",[a._v("根据framework/base/目录下Android.bp中的提示：")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://raw.githubusercontent.com/shug666/image/main/images/dda77758d575415e989f74fdcb56ea24.png",alt:"在这里插入图片描述"}})]),a._v(" "),r("p",[r("img",{attrs:{src:"https://raw.githubusercontent.com/shug666/image/main/images/f2914084287d4f8199879098e1157e67.png",alt:"在这里插入图片描述"}})]),a._v(" "),r("p",[a._v("3、如果 frameworks/base/services 下有修改，则也要编译，在目录 work/source/frameworks/base/services/java/ 执行mm 编译services.jar")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://raw.githubusercontent.com/shug666/image/main/images/e10183647845435e8d833611f0793a19.png",alt:"在这里插入图片描述"}})]),a._v(" "),r("p",[a._v("编译生成的文件都位于你的out/target/product/xxx/system/frameworks/目录下")]),a._v(" "),r("p",[a._v("注：若不生成新的apk、jar包文件，请将旧的.apk、.jar包删除")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://raw.githubusercontent.com/shug666/image/main/images/45f720a2718e4826878f3ff025678c3b.png",alt:"在这里插入图片描述"}})]),a._v(" "),r("h2",{attrs:{id:"二-验证修改后的效果"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#二-验证修改后的效果"}},[a._v("#")]),a._v(" 二 : 验证修改后的效果")]),a._v(" "),r("p",[a._v("adb root")]),a._v(" "),r("p",[a._v("adb remount")]),a._v(" "),r("p",[a._v("adb push framework-res.apk /system/framework/")]),a._v(" "),r("p",[a._v("adb push framework.jar /system/framework/")]),a._v(" "),r("p",[a._v("adb push secondary_framework.jar /system/framework/ (如果存在secondary_framework.jar,需要push)")]),a._v(" "),r("p",[a._v("adb push services.jar /system/framework/ （如果service有修改，需要push，还有一些类似service模块带有单独Android.bp的模块等，这里就不一一举例）")]),a._v(" "),r("p",[a._v("adb reboot 重启设备。")]),a._v(" "),r("h2",{attrs:{id:"三-总结"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#三-总结"}},[a._v("#")]),a._v(" 三 : 总结")]),a._v(" "),r("p",[a._v("在开发过程中,尤其是framework相关开发时,有时候需要重新编译资源文件.编译顺序和注意事项如下(均在源码根目录):")]),a._v(" "),r("p",[a._v("资源文件位置:frameworks/base/core/res，编译后生成的文件:framework-res.apk 另外com.android.internal.R会更新这个R.java所在目录/out/target/common/R/com/android/internal.")]),a._v(" "),r("p",[a._v("编译资源后,必须重新编译framework.jar.")]),a._v(" "),r("p",[a._v("如果在frameworks/base/core/res执行mm时并不重新编译,请使用mm -B")]),a._v(" "),r("p",[a._v("资源文件要小写")]),a._v(" "),r("h2",{attrs:{id:"四-其他模块单编介绍"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#四-其他模块单编介绍"}},[a._v("#")]),a._v(" 四：其他模块单编介绍")]),a._v(" "),r("p",[a._v("mmm system/core/init 等同于 cd system/core/init 进入目录后再执行mm。")]),a._v(" "),r("p",[a._v("编译系统采用的是增量编译，只会编译发生变化的目标文件。当需要重新编译所有的相关模块，则需要编译命令后增加参数-B，比如make -B [module_name]，或者 mm -B [module_path]。")]),a._v(" "),r("p",[r("img",{attrs:{src:"https://raw.githubusercontent.com/shug666/image/main/images/59d0dfef3c4242c8822689a731530e47.png",alt:"在这里插入图片描述"}})]),a._v(" "),r("p",[a._v("本文转自 "),r("a",{attrs:{href:"https://blog.csdn.net/z1804362542/article/details/125977277?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522168128706916800192216921%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=168128706916800192216921&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-125977277-null-null.142%5Ev82%5Einsert_down38,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&utm_term=framework%20%E5%8D%95%E7%BC%96&spm=1018.2226.3001.4187",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://blog.csdn.net/z1804362542/article/details/125977277?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522168128706916800192216921%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=168128706916800192216921&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-125977277-null-null.142^v82^insert_down38,201^v4^add_ask,239^v2^insert_chatgpt&utm_term=framework%20%E5%8D%95%E7%BC%96&spm=1018.2226.3001.4187"),r("OutboundLink")],1),a._v("，如有侵权，请联系删除。")])])}),[],!1,null,null,null);r.default=t.exports}}]);